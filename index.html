<!DOCTYPE html>
<html lang="pl">
<head>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a73e8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <script>
        window.addEventListener('beforeinstallprompt', (e) => {
        // Zapobiega domyÅ›lnemu zachowaniu Chrome (opcjonalne)
        // e.preventDefault(); 
        
        // MoÅ¼esz tutaj np. pokazaÄ‡ wÅ‚asny przycisk "ZAINSTALUJ APLIKACJÄ˜"
        console.log('Strona jest gotowa do instalacji jako PWA');
        });

        // Sprawdzenie czy to iPhone i czy NIE jest w trybie standalone
        const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches;

        if (isIos && !isStandalone) {
        // Tutaj moÅ¼esz wyÅ›wietliÄ‡ np. showToast('Aby zainstalowaÄ‡: kliknij UdostÄ™pnij -> Do ekranu poczÄ…tkowego');
        console.log('Sugestia instalacji dla iOS');
        }

        // Rejestracja Service Workera
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('PWA Gotowe!', reg))
                .catch(err => console.log('BÅ‚Ä…d PWA', err));
            });
        }
    </script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instalator Pro</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <header>
            <h1>NiezbÄ™dnik Instalatora</h1>
        </header>

        <main class="grid-container">
           
            <div class="tile" onclick="location.href='tools-src/nadajniki.html'">
                <span class="icon">ğŸ—¼</span>
                <span class="label">Nadajniki DVB-T</span>
            </div>
            <div class="tile" onclick="location.href='tools-src/bibliotekaDVBT.html'">
                <span class="icon">ğŸ“º</span>
                <span class="label">Info DVB-T</span>
            </div>
             <div class="tile" onclick="location.href='tools-src/satelity.html'">
                <span class="icon">ğŸ“¡</span>
                <span class="label">SAT Azymut / Elewacja</span>
            </div>
            <div class="tile" onclick="location.href='tools-src/bibliotekaSAT.html'">
                <span class="icon">ğŸ›°ï¸</span>
                <span class="label">Info SAT</span>
            </div>
           
            
            <div class="tile" onclick="location.href='tools-src/instrukcje.html'">
                <span class="icon">ğŸ“–</span>
                <span class="label">Instrukcje</span>
            </div>
            <div class="tile" onclick="location.href='tools-src/cennik.html'">
                <span class="icon">ğŸ’°</span>
                <span class="label">Cennik</span>
            </div>
            <div class="tile" onclick="location.href='tools-src/Jednostki.html'">
                <span class="icon">â†”ï¸</span>
                <span class="label">Konwerter siÅ‚y sygnaÅ‚u</span>
            </div>
            <div class="tile" onclick="location.href='tools-src/internet.html'">
                <span class="icon">ğŸŒ</span>
                <span class="label">INTERNET / LTE</span>
            </div>
            <div class="tile" onclick="location.href='tools-src/notatki.html'">
                <span class="icon">ğŸ“</span>
                <span class="label">Notatki</span>
            </div>
            <div class="tile" onclick="location.href='tools-src/raporty.html'">
                <span class="icon">ğŸ“‹</span>
                <span class="label">Raporty</span>
            </div>
        </main>

        <footer style="text-align: center; color: gray; font-size: 10px; padding: 10px;">
            v<span id="app-version">1.x</span>, <span id="app-status">tryb sprawdzania...</span>
        </footer>
    </div>
</body>

    <script>
        let backClickCounter = 0;

        document.addEventListener("deviceready", onDeviceReady, false);
        
        function onDeviceReady() {
            // 1. WERSJA RÄ˜CZNA (Zmieniamy tylko tutaj przy aktualizacji)
            const manualVersion = "1.1.0"; 
            document.getElementById('app-version').innerText = manualVersion;
        
            const statusSpan = document.getElementById('app-status');
        
            // 2. STATUS SIECI
            function updateOnlineStatus() {
                if (navigator.onLine) {
                    statusSpan.innerText = "Tryb ONLINE gotowy";
                    statusSpan.style.color = "#03dac6";
                } else {
                    statusSpan.innerText = "Tryb OFFLINE gotowy";
                    statusSpan.style.color = "gray";
                }
            }
            updateOnlineStatus();
        
            document.addEventListener("offline", updateOnlineStatus, false);
            document.addEventListener("online", updateOnlineStatus, false);
        
            // 3. OBSÅUGA PRZYCISKU WSTECZ (BEZ PLUGINU XTOAST)
            document.addEventListener("backbutton", function (e) {
                const path = window.location.pathname;
                if (path.endsWith("index.html") || path === "/" || path.includes("android_asset/www/index.html")) {
                    e.preventDefault();
                    backClickCounter++;
                    
                    if (backClickCounter === 1) {
                        // UÅ¼ywamy naszej wÅ‚asnej funkcji powiadomienia zamiast pluginu
                        showToast('Kliknij jeszcze raz, aby wyjÅ›Ä‡');
                        setTimeout(() => { backClickCounter = 0; }, 2000);
                    } else {
                        navigator.app.exitApp();
                    }
                } else {
                    window.location.replace("index.html");
                }
            }, false);
        }
        
        // Nasza wÅ‚asna, darmowa funkcja powiadomienia na ekranie
        function showToast(message) {
            // Usuwamy stare powiadomienie jeÅ›li jeszcze istnieje
            const oldToast = document.getElementById('custom-toast');
            if (oldToast) oldToast.remove();
        
            const statusDiv = document.createElement('div');
            statusDiv.id = 'custom-toast';
            statusDiv.style = "position:fixed; bottom:50px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.8); color:white; padding:12px 25px; border-radius:25px; z-index:9999; font-size:14px; white-space:nowrap; border: 1px solid #444;";
            statusDiv.innerText = message;
            document.body.appendChild(statusDiv);
        
            // Animacja znikania
            setTimeout(() => {
                statusDiv.style.opacity = '0';
                statusDiv.style.transition = 'opacity 0.5s ease';
                setTimeout(() => statusDiv.remove(), 500);
            }, 2000);
        }
    </script>
</html>